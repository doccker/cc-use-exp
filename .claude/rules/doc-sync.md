---
paths: "**/*"
---

# 文档同步规则

版本：v3.0
作者：wwj
更新：2025-12

> **部署位置**: `~/.claude/rules/doc-sync.md`
> **生效范围**: 所有项目

---

## 触发条件

当以下变更发生时，必须提醒用户确认是否需要更新相关文档。

### 1. 配置变更（本项目特有）

| 变更类型 | 需要更新的文档 |
|---------|---------------|
| 新增/修改/删除 `commands/` | README.md（命令列表） |
| 新增/修改/删除 `skills/` | README.md（技能列表） |
| 新增/修改/删除 `rules/` | README.md（规则列表） |
| 修改 CLAUDE.md 核心配置 | README.md（如涉及技术栈/偏好变更）|

### 2. 项目结构变更（通用）

- 新增或删除核心目录（如 `cmd/`、`internal/`、`pkg/`、`web/`、`src/` 等）
- 新增或删除顶层目录

→ 需要更新：CLAUDE.md

### 3. 技术栈变更（通用）

- go.mod 中新增或移除主要依赖
- package.json 中新增或移除主要依赖
- pom.xml 中新增或移除主要依赖
- 切换框架或核心库

→ 需要更新：CLAUDE.md

### 4. 构建/部署变更（通用）

- 修改启动脚本（restart.sh, start.sh, stop.sh）
- 修改编译命令或输出路径
- 修改前端构建配置
- 修改 Docker 配置

→ 需要更新：CLAUDE.md

---

## 提醒格式

### 配置变更时

```
检测到配置变更：
- [变更描述，如：新增命令 /xxx]

README.md 可能需要更新：
- [ ] [具体位置，如：命令列表]

是否需要同步更新？
1. 是，帮我更新
2. 否，跳过
```

### 项目结构/技术栈变更时

```
检测到项目结构/技术栈变更：
- [变更描述]

是否需要同步更新 CLAUDE.md？
1. 是，帮我更新
2. 否，跳过
```

---

## 不触发的情况

以下情况不需要提醒：

- 普通业务代码修改
- bug 修复
- 现有模块内的功能调整
- 文档/注释更新（非配置文档）
- 测试代码变更
- 配置值修改（非结构性）

---

## 更新原则

| 原则 | 说明 |
|------|------|
| 最小更新 | 只更新变更相关部分 |
| 保持格式 | 遵循现有文档格式 |
| 准确描述 | 确保描述与实际代码一致 |
| 同步更新 | 相关文档一起更新，保持一致性 |

---

## 文档关系

```
配置变更
    │
    ├─ commands/ ──→ README.md（命令列表）
    ├─ skills/ ────→ README.md（技能列表）
    ├─ rules/ ─────→ README.md（规则列表）
    └─ CLAUDE.md ──→ README.md（如涉及核心变更）

项目变更
    │
    └─ 结构/技术栈/构建 ──→ CLAUDE.md
```

---

## 规则溯源要求

当回复明确受到本规则约束时，在回复末尾声明：

```
> 📋 本回复遵循规则：`doc-sync.md` - [具体章节]
```
